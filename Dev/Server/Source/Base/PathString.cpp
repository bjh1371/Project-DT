////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// \file PathString.cpp
/// \author bjh1371
/// \date 2015/07/18
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "PathString.h"

namespace
{
	__declspec(thread) TCHAR t_Dir[MAX_PATH] = {0, };          ///< 디렉터리 
	__declspec(thread) TCHAR t_FileName[FILENAME_MAX] = {0, }; ///< 파일 이름
	__declspec(thread) TCHAR t_FullDir[MAX_PATH] = {0, };      ///< 디렉터리 + 파일 이름
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// \brief 생성자
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CPathString::CPathString()
{
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// \brief 소멸자
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CPathString::~CPathString()
{
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// \brief 
/// \return LPCTSTR
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
LPCTSTR CPathString::GetCurrentDir()
{
	if (t_Dir[0] == 0)
	{
		GetModuleFileName(NULL, t_Dir, MAX_PATH);
		LPTSTR dot = _tcsrchr(t_Dir, '\\');
		*dot = 0;
	}

	return t_Dir;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// \brief 
/// \return LPCTSTR
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
LPCTSTR CPathString::GetCurrentFullDir()
{
	if (t_FullDir[0] == 0)
	{
		GetModuleFileName(NULL, t_FullDir, MAX_PATH);
	}

	return t_FullDir;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// \brief 
/// \return LPCTSTR
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
LPCTSTR CPathString::GetCurrentFileName()
{
	if (t_FileName[0] == 0)
	{
		if (t_FullDir[0] == 0)
		{
			GetModuleFileName(NULL, t_FullDir, MAX_PATH);
		}

		LPTSTR dot = _tcsrchr(t_FullDir, '\\');
		
		// 파일 이름 저장
		_tcsncpy_s(t_FileName, ARRAYSIZE(t_FileName), dot + 1, _tcslen(dot) * sizeof(TCHAR));
	}

	return t_FileName;
}
